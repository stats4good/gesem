require(kableExtra)
install.packages("kableExtra")
list(REG =
table(ifelse(df$REG_OCOR == "Ignorado", NA, df$REG_OCOR), df$EV, useNA = "ifany")  %>%
as_data_frame() %>%
setNames(c("REG", "EV", "Freq")) %>%
mutate(REG = ifelse(is.na(REG), "Ignorado", REG),
EV = ifelse(is.na(EV), "Ignorado", EV)) %>%
group_by(EV) %>%
do(data = (.)) %>%
select(data) %>%
lapply(function(x) {(x)}) %>% .[[1]] %>%
bind_cols() %>%
select(REG, starts_with("Freq")) %>%
group_by(REG) %>%
transmute("Nível de agregação" = REG,
"% Estupro de Vulnerável" = paste0(format(Freq1 / sum(Freq, Freq1, Freq2) * 100,
digits = 2,
nsmall = 2),
" (",
format(Freq1, big.mark = "."),
" / ",
format(sum(Freq, Freq1, Freq2), big.mark = "."),
")"),
"% Demais casos de estupro" = paste0(format(Freq / sum(Freq, Freq1, Freq2) * 100,
digits = 2,
nsmall = 2),
" (",
format(Freq, big.mark = "."),
" / ",
format(sum(Freq, Freq1, Freq2), big.mark = "."),
")"),
"% Ignorado" = paste0(format(Freq2 / sum(Freq, Freq1, Freq2) * 100,
digits = 2,
nsmall = 2),
" (",
format(Freq2, big.mark = "."),
" / ",
format(sum(Freq, Freq1, Freq2), big.mark = "."),
")"),
freqr1 = Freq1 / sum(Freq, Freq1, Freq2),
freqr2 = Freq / sum(Freq, Freq1, Freq2),
chance = freqr1/freqr2,
varaux = (REG == "Ignorado")) %>%
ungroup() %>%
mutate("Razão de chances" = chance / chance[REG == "Sudeste"]) %>%
group_by(varaux) %>%
arrange(desc(`Razão de chances`), .by_group = TRUE) %>%
ungroup() %>%
select(-REG, -freqr1, -freqr2, -varaux) %>%
select(`Nível de agregação`,
`% Estupro de Vulnerável`,
`% Demais casos de estupro`,
`% Ignorado`,
`Razão de chances`),
ZONA =
table(ifelse(df$ZONA_OCOR == "Ignorado", NA, df$ZONA_OCOR), df$EV, useNA = "ifany")  %>%
as_data_frame() %>%
setNames(c("ZONA", "EV", "Freq")) %>%
mutate(ZONA = ifelse(is.na(ZONA), "Ignorado", ZONA),
EV = ifelse(is.na(EV), "Ignorado", EV)) %>%
group_by(EV) %>%
do(data = (.)) %>%
select(data) %>%
lapply(function(x) {(x)}) %>% .[[1]] %>%
bind_cols() %>%
select(ZONA, starts_with("Freq")) %>%
group_by(ZONA) %>%
transmute("Nível de agregação" = ZONA,
"% Estupro de Vulnerável" = paste0(format(Freq1 / sum(Freq, Freq1, Freq2) * 100,
digits = 2,
nsmall = 2),
" (",
format(Freq1, big.mark = "."),
" / ",
format(sum(Freq, Freq1, Freq2), big.mark = "."),
")"),
"% Demais casos de estupro" = paste0(format(Freq / sum(Freq, Freq1, Freq2) * 100,
digits = 2,
nsmall = 2),
" (",
format(Freq, big.mark = "."),
" / ",
format(sum(Freq, Freq1, Freq2), big.mark = "."),
")"),
"% Ignorado" = paste0(format(Freq2 / sum(Freq, Freq1, Freq2) * 100,
digits = 2,
nsmall = 2),
" (",
format(Freq2, big.mark = "."),
" / ",
format(sum(Freq, Freq1, Freq2), big.mark = "."),
")"),
freqr1 = Freq1 / sum(Freq, Freq1, Freq2),
freqr2 = Freq / sum(Freq, Freq1, Freq2),
chance = freqr1/freqr2,
varaux = (ZONA == "Ignorado")) %>%
ungroup() %>%
mutate("Razão de chances" = chance / chance[ZONA == "Urbana"]) %>%
group_by(varaux) %>%
arrange(desc(`Razão de chances`), .by_group = TRUE) %>%
ungroup() %>%
select(-ZONA, -freqr1, -freqr2, -varaux) %>%
select(`Nível de agregação`,
`% Estupro de Vulnerável`,
`% Demais casos de estupro`,
`% Ignorado`,
`Razão de chances`),
LOCAL =
table(ifelse(df$LOCAL_OCOR == "Ignorado", NA, df$LOCAL_OCOR), df$EV, useNA = "ifany") %>%
as_data_frame() %>%
setNames(c("LOCAL", "EV", "Freq")) %>%
mutate(LOCAL = as.character(ifelse(is.na(LOCAL), "Ignorado", LOCAL)),
EV = ifelse(is.na(EV), "Ignorado", EV)) %>%
group_by(EV) %>%
do(data = (.)) %>%
select(data) %>%
lapply(function(x) {(x)}) %>% .[[1]] %>%
bind_cols() %>%
select(LOCAL, starts_with("Freq")) %>%
group_by(LOCAL) %>%
transmute("Nível de agregação" = ifelse(LOCAL == "Via publica", "Via pública", LOCAL),
"Nível de agregação" = ifelse(LOCAL == "Outro", "Outros", LOCAL),
"% Estupro de Vulnerável" = paste0(format(Freq1 / sum(Freq, Freq1, Freq2) * 100,
digits = 2,
nsmall = 2),
" (",
format(Freq1, big.mark = "."),
" / ",
format(sum(Freq, Freq1, Freq2), big.mark = "."),
")"),
"% Demais casos de estupro" = paste0(format(Freq / sum(Freq, Freq1, Freq2) * 100,
digits = 2,
nsmall = 2),
" (",
format(Freq, big.mark = "."),
" / ",
format(sum(Freq, Freq1, Freq2), big.mark = "."),
")"),
"% Ignorado" = paste0(format(Freq2 / sum(Freq, Freq1, Freq2) * 100,
digits = 2,
nsmall = 2),
" (",
format(Freq2, big.mark = "."),
" / ",
format(sum(Freq, Freq1, Freq2), big.mark = "."),
")"),
freqr1 = Freq1 / sum(Freq, Freq1, Freq2),
freqr2 = Freq / sum(Freq, Freq1, Freq2),
chance = freqr1/freqr2,
varaux = (LOCAL == "Ignorado")) %>%
ungroup() %>%
mutate("Razão de chances" = chance / chance[LOCAL == "Via publica"]) %>%
group_by(varaux) %>%
arrange(desc(`Razão de chances`), .by_group = TRUE) %>%
ungroup() %>%
select(-LOCAL, -freqr1, -freqr2, -varaux) %>%
select(`Nível de agregação`,
`% Estupro de Vulnerável`,
`% Demais casos de estupro`,
`% Ignorado`,
`Razão de chances`)
) %>%
bind_rows() %>%
kable(caption = "Tabela 01: Apresenta as porcentagens e contagens das notificações de estupros de vulnerável e demais casos de estupro por região, zona e  local de ocorrência no período de 2011 a 2016, Brasil:", align = c("l", "c", "c", "c", "c"), format.args = list(big.mark = ".")) %>%
kable_styling(bootstrap_options = c("striped", "hover", "condensed", "responsive")) %>%
group_rows("Zona", 7, 10) %>%
group_rows("Local", 11, 20) %>%
column_spec(2, bold = TRUE, color = "white", background = "purple") %>%
column_spec(3, bold = TRUE, color = "black", background = "yellow") %>%
column_spec(5, bold = TRUE, color = "black", background = "grey")
require(dplyr)
list(REG =
table(ifelse(df$REG_OCOR == "Ignorado", NA, df$REG_OCOR), df$EV, useNA = "ifany")  %>%
as_data_frame() %>%
setNames(c("REG", "EV", "Freq")) %>%
mutate(REG = ifelse(is.na(REG), "Ignorado", REG),
EV = ifelse(is.na(EV), "Ignorado", EV)) %>%
group_by(EV) %>%
do(data = (.)) %>%
select(data) %>%
lapply(function(x) {(x)}) %>% .[[1]] %>%
bind_cols() %>%
select(REG, starts_with("Freq")) %>%
group_by(REG) %>%
transmute("Nível de agregação" = REG,
"% Estupro de Vulnerável" = paste0(format(Freq1 / sum(Freq, Freq1, Freq2) * 100,
digits = 2,
nsmall = 2),
" (",
format(Freq1, big.mark = "."),
" / ",
format(sum(Freq, Freq1, Freq2), big.mark = "."),
")"),
"% Demais casos de estupro" = paste0(format(Freq / sum(Freq, Freq1, Freq2) * 100,
digits = 2,
nsmall = 2),
" (",
format(Freq, big.mark = "."),
" / ",
format(sum(Freq, Freq1, Freq2), big.mark = "."),
")"),
"% Ignorado" = paste0(format(Freq2 / sum(Freq, Freq1, Freq2) * 100,
digits = 2,
nsmall = 2),
" (",
format(Freq2, big.mark = "."),
" / ",
format(sum(Freq, Freq1, Freq2), big.mark = "."),
")"),
freqr1 = Freq1 / sum(Freq, Freq1, Freq2),
freqr2 = Freq / sum(Freq, Freq1, Freq2),
chance = freqr1/freqr2,
varaux = (REG == "Ignorado")) %>%
ungroup() %>%
mutate("Razão de chances" = chance / chance[REG == "Sudeste"]) %>%
group_by(varaux) %>%
arrange(desc(`Razão de chances`), .by_group = TRUE) %>%
ungroup() %>%
select(-REG, -freqr1, -freqr2, -varaux) %>%
select(`Nível de agregação`,
`% Estupro de Vulnerável`,
`% Demais casos de estupro`,
`% Ignorado`,
`Razão de chances`),
ZONA =
table(ifelse(df$ZONA_OCOR == "Ignorado", NA, df$ZONA_OCOR), df$EV, useNA = "ifany")  %>%
as_data_frame() %>%
setNames(c("ZONA", "EV", "Freq")) %>%
mutate(ZONA = ifelse(is.na(ZONA), "Ignorado", ZONA),
EV = ifelse(is.na(EV), "Ignorado", EV)) %>%
group_by(EV) %>%
do(data = (.)) %>%
select(data) %>%
lapply(function(x) {(x)}) %>% .[[1]] %>%
bind_cols() %>%
select(ZONA, starts_with("Freq")) %>%
group_by(ZONA) %>%
transmute("Nível de agregação" = ZONA,
"% Estupro de Vulnerável" = paste0(format(Freq1 / sum(Freq, Freq1, Freq2) * 100,
digits = 2,
nsmall = 2),
" (",
format(Freq1, big.mark = "."),
" / ",
format(sum(Freq, Freq1, Freq2), big.mark = "."),
")"),
"% Demais casos de estupro" = paste0(format(Freq / sum(Freq, Freq1, Freq2) * 100,
digits = 2,
nsmall = 2),
" (",
format(Freq, big.mark = "."),
" / ",
format(sum(Freq, Freq1, Freq2), big.mark = "."),
")"),
"% Ignorado" = paste0(format(Freq2 / sum(Freq, Freq1, Freq2) * 100,
digits = 2,
nsmall = 2),
" (",
format(Freq2, big.mark = "."),
" / ",
format(sum(Freq, Freq1, Freq2), big.mark = "."),
")"),
freqr1 = Freq1 / sum(Freq, Freq1, Freq2),
freqr2 = Freq / sum(Freq, Freq1, Freq2),
chance = freqr1/freqr2,
varaux = (ZONA == "Ignorado")) %>%
ungroup() %>%
mutate("Razão de chances" = chance / chance[ZONA == "Urbana"]) %>%
group_by(varaux) %>%
arrange(desc(`Razão de chances`), .by_group = TRUE) %>%
ungroup() %>%
select(-ZONA, -freqr1, -freqr2, -varaux) %>%
select(`Nível de agregação`,
`% Estupro de Vulnerável`,
`% Demais casos de estupro`,
`% Ignorado`,
`Razão de chances`),
LOCAL =
table(ifelse(df$LOCAL_OCOR == "Ignorado", NA, df$LOCAL_OCOR), df$EV, useNA = "ifany") %>%
as_data_frame() %>%
setNames(c("LOCAL", "EV", "Freq")) %>%
mutate(LOCAL = as.character(ifelse(is.na(LOCAL), "Ignorado", LOCAL)),
EV = ifelse(is.na(EV), "Ignorado", EV)) %>%
group_by(EV) %>%
do(data = (.)) %>%
select(data) %>%
lapply(function(x) {(x)}) %>% .[[1]] %>%
bind_cols() %>%
select(LOCAL, starts_with("Freq")) %>%
group_by(LOCAL) %>%
transmute("Nível de agregação" = ifelse(LOCAL == "Via publica", "Via pública", LOCAL),
"Nível de agregação" = ifelse(LOCAL == "Outro", "Outros", LOCAL),
"% Estupro de Vulnerável" = paste0(format(Freq1 / sum(Freq, Freq1, Freq2) * 100,
digits = 2,
nsmall = 2),
" (",
format(Freq1, big.mark = "."),
" / ",
format(sum(Freq, Freq1, Freq2), big.mark = "."),
")"),
"% Demais casos de estupro" = paste0(format(Freq / sum(Freq, Freq1, Freq2) * 100,
digits = 2,
nsmall = 2),
" (",
format(Freq, big.mark = "."),
" / ",
format(sum(Freq, Freq1, Freq2), big.mark = "."),
")"),
"% Ignorado" = paste0(format(Freq2 / sum(Freq, Freq1, Freq2) * 100,
digits = 2,
nsmall = 2),
" (",
format(Freq2, big.mark = "."),
" / ",
format(sum(Freq, Freq1, Freq2), big.mark = "."),
")"),
freqr1 = Freq1 / sum(Freq, Freq1, Freq2),
freqr2 = Freq / sum(Freq, Freq1, Freq2),
chance = freqr1/freqr2,
varaux = (LOCAL == "Ignorado")) %>%
ungroup() %>%
mutate("Razão de chances" = chance / chance[LOCAL == "Via publica"]) %>%
group_by(varaux) %>%
arrange(desc(`Razão de chances`), .by_group = TRUE) %>%
ungroup() %>%
select(-LOCAL, -freqr1, -freqr2, -varaux) %>%
select(`Nível de agregação`,
`% Estupro de Vulnerável`,
`% Demais casos de estupro`,
`% Ignorado`,
`Razão de chances`)
) %>%
bind_rows() %>%
kable(caption = "Tabela 01: Apresenta as porcentagens e contagens das notificações de estupros de vulnerável e demais casos de estupro por região, zona e  local de ocorrência no período de 2011 a 2016, Brasil:", align = c("l", "c", "c", "c", "c"), format.args = list(big.mark = ".")) %>%
kable_styling(bootstrap_options = c("striped", "hover", "condensed", "responsive")) %>%
group_rows("Zona", 7, 10) %>%
group_rows("Local", 11, 20) %>%
column_spec(2, bold = TRUE, color = "white", background = "purple") %>%
column_spec(3, bold = TRUE, color = "black", background = "yellow") %>%
column_spec(5, bold = TRUE, color = "black", background = "grey")
require(kableExtra)
require(knitr)
list(REG =
table(ifelse(df$REG_OCOR == "Ignorado", NA, df$REG_OCOR), df$EV, useNA = "ifany")  %>%
as_data_frame() %>%
setNames(c("REG", "EV", "Freq")) %>%
mutate(REG = ifelse(is.na(REG), "Ignorado", REG),
EV = ifelse(is.na(EV), "Ignorado", EV)) %>%
group_by(EV) %>%
do(data = (.)) %>%
select(data) %>%
lapply(function(x) {(x)}) %>% .[[1]] %>%
bind_cols() %>%
select(REG, starts_with("Freq")) %>%
group_by(REG) %>%
transmute("Nível de agregação" = REG,
"% Estupro de Vulnerável" = paste0(format(Freq1 / sum(Freq, Freq1, Freq2) * 100,
digits = 2,
nsmall = 2),
" (",
format(Freq1, big.mark = "."),
" / ",
format(sum(Freq, Freq1, Freq2), big.mark = "."),
")"),
"% Demais casos de estupro" = paste0(format(Freq / sum(Freq, Freq1, Freq2) * 100,
digits = 2,
nsmall = 2),
" (",
format(Freq, big.mark = "."),
" / ",
format(sum(Freq, Freq1, Freq2), big.mark = "."),
")"),
"% Ignorado" = paste0(format(Freq2 / sum(Freq, Freq1, Freq2) * 100,
digits = 2,
nsmall = 2),
" (",
format(Freq2, big.mark = "."),
" / ",
format(sum(Freq, Freq1, Freq2), big.mark = "."),
")"),
freqr1 = Freq1 / sum(Freq, Freq1, Freq2),
freqr2 = Freq / sum(Freq, Freq1, Freq2),
chance = freqr1/freqr2,
varaux = (REG == "Ignorado")) %>%
ungroup() %>%
mutate("Razão de chances" = chance / chance[REG == "Sudeste"]) %>%
group_by(varaux) %>%
arrange(desc(`Razão de chances`), .by_group = TRUE) %>%
ungroup() %>%
select(-REG, -freqr1, -freqr2, -varaux) %>%
select(`Nível de agregação`,
`% Estupro de Vulnerável`,
`% Demais casos de estupro`,
`% Ignorado`,
`Razão de chances`),
ZONA =
table(ifelse(df$ZONA_OCOR == "Ignorado", NA, df$ZONA_OCOR), df$EV, useNA = "ifany")  %>%
as_data_frame() %>%
setNames(c("ZONA", "EV", "Freq")) %>%
mutate(ZONA = ifelse(is.na(ZONA), "Ignorado", ZONA),
EV = ifelse(is.na(EV), "Ignorado", EV)) %>%
group_by(EV) %>%
do(data = (.)) %>%
select(data) %>%
lapply(function(x) {(x)}) %>% .[[1]] %>%
bind_cols() %>%
select(ZONA, starts_with("Freq")) %>%
group_by(ZONA) %>%
transmute("Nível de agregação" = ZONA,
"% Estupro de Vulnerável" = paste0(format(Freq1 / sum(Freq, Freq1, Freq2) * 100,
digits = 2,
nsmall = 2),
" (",
format(Freq1, big.mark = "."),
" / ",
format(sum(Freq, Freq1, Freq2), big.mark = "."),
")"),
"% Demais casos de estupro" = paste0(format(Freq / sum(Freq, Freq1, Freq2) * 100,
digits = 2,
nsmall = 2),
" (",
format(Freq, big.mark = "."),
" / ",
format(sum(Freq, Freq1, Freq2), big.mark = "."),
")"),
"% Ignorado" = paste0(format(Freq2 / sum(Freq, Freq1, Freq2) * 100,
digits = 2,
nsmall = 2),
" (",
format(Freq2, big.mark = "."),
" / ",
format(sum(Freq, Freq1, Freq2), big.mark = "."),
")"),
freqr1 = Freq1 / sum(Freq, Freq1, Freq2),
freqr2 = Freq / sum(Freq, Freq1, Freq2),
chance = freqr1/freqr2,
varaux = (ZONA == "Ignorado")) %>%
ungroup() %>%
mutate("Razão de chances" = chance / chance[ZONA == "Urbana"]) %>%
group_by(varaux) %>%
arrange(desc(`Razão de chances`), .by_group = TRUE) %>%
ungroup() %>%
select(-ZONA, -freqr1, -freqr2, -varaux) %>%
select(`Nível de agregação`,
`% Estupro de Vulnerável`,
`% Demais casos de estupro`,
`% Ignorado`,
`Razão de chances`),
LOCAL =
table(ifelse(df$LOCAL_OCOR == "Ignorado", NA, df$LOCAL_OCOR), df$EV, useNA = "ifany") %>%
as_data_frame() %>%
setNames(c("LOCAL", "EV", "Freq")) %>%
mutate(LOCAL = as.character(ifelse(is.na(LOCAL), "Ignorado", LOCAL)),
EV = ifelse(is.na(EV), "Ignorado", EV)) %>%
group_by(EV) %>%
do(data = (.)) %>%
select(data) %>%
lapply(function(x) {(x)}) %>% .[[1]] %>%
bind_cols() %>%
select(LOCAL, starts_with("Freq")) %>%
group_by(LOCAL) %>%
transmute("Nível de agregação" = ifelse(LOCAL == "Via publica", "Via pública", LOCAL),
"Nível de agregação" = ifelse(LOCAL == "Outro", "Outros", LOCAL),
"% Estupro de Vulnerável" = paste0(format(Freq1 / sum(Freq, Freq1, Freq2) * 100,
digits = 2,
nsmall = 2),
" (",
format(Freq1, big.mark = "."),
" / ",
format(sum(Freq, Freq1, Freq2), big.mark = "."),
")"),
"% Demais casos de estupro" = paste0(format(Freq / sum(Freq, Freq1, Freq2) * 100,
digits = 2,
nsmall = 2),
" (",
format(Freq, big.mark = "."),
" / ",
format(sum(Freq, Freq1, Freq2), big.mark = "."),
")"),
"% Ignorado" = paste0(format(Freq2 / sum(Freq, Freq1, Freq2) * 100,
digits = 2,
nsmall = 2),
" (",
format(Freq2, big.mark = "."),
" / ",
format(sum(Freq, Freq1, Freq2), big.mark = "."),
")"),
freqr1 = Freq1 / sum(Freq, Freq1, Freq2),
freqr2 = Freq / sum(Freq, Freq1, Freq2),
chance = freqr1/freqr2,
varaux = (LOCAL == "Ignorado")) %>%
ungroup() %>%
mutate("Razão de chances" = chance / chance[LOCAL == "Via publica"]) %>%
group_by(varaux) %>%
arrange(desc(`Razão de chances`), .by_group = TRUE) %>%
ungroup() %>%
select(-LOCAL, -freqr1, -freqr2, -varaux) %>%
select(`Nível de agregação`,
`% Estupro de Vulnerável`,
`% Demais casos de estupro`,
`% Ignorado`,
`Razão de chances`)
) %>%
bind_rows() %>%
kable(caption = "Tabela 01: Apresenta as porcentagens e contagens das notificações de estupros de vulnerável e demais casos de estupro por região, zona e  local de ocorrência no período de 2011 a 2016, Brasil:", align = c("l", "c", "c", "c", "c"), format.args = list(big.mark = ".")) %>%
kable_styling(bootstrap_options = c("striped", "hover", "condensed", "responsive")) %>%
group_rows("Zona", 7, 10) %>%
group_rows("Local", 11, 20) %>%
column_spec(2, bold = TRUE, color = "white", background = "purple") %>%
column_spec(3, bold = TRUE, color = "black", background = "yellow") %>%
column_spec(5, bold = TRUE, color = "black", background = "grey")
